<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Valorant JS - Versiyon 0.2</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Segoe UI', sans-serif; }
        #crosshair {
            position: absolute; top: 50%; left: 50%;
            width: 12px; height: 12px; border: 2px solid #00ff00;
            transform: translate(-50%, -50%); pointer-events: none;
            border-radius: 50%;
        }
        #ui {
            position: absolute; bottom: 30px; left: 30px; color: white;
            text-shadow: 2px 2px #000; letter-spacing: 2px;
        }
        #instructions {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: white; text-align: center; background: rgba(0,0,0,0.85); 
            padding: 30px; border: 2px solid #ff4655; cursor: pointer;
        }
        .flash {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; opacity: 0; pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="crosshair"></div>
    <div id="flash-effect" class="flash"></div>
    <div id="ui">
        <h1 id="ammo">AMMO: 25 / ∞</h1>
        <p style="color: #ff4655; font-weight: bold;">[SOL TIK] ATEŞ ET | [WASD] HAREKET</p>
    </div>
    <div id="instructions" onclick="this.style.display='none'; document.body.requestPointerLock();">
        <h1 style="color: #ff4655;">VALORANT JS CLONE</h1>
        <p>Hata Düzeltildi & Silah Eklendi</p>
        <p>Başlamak için Tıkla</p>
    </div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- SAHNE KURULUMU ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x1a1a1a);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- IŞIKLANDIRMA ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const pointLight = new THREE.PointLight(0xffffff, 1);
        camera.add(pointLight); // Işık kamerayı takip etsin
        scene.add(camera);

        // --- ZEMİN VE DUVARLAR ---
        const floor = new THREE.Mesh(
            new THREE.PlaneGeometry(200, 200),
            new THREE.MeshPhongMaterial({ color: 0x333333 })
        );
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        // --- SİLAH MODELİ (Basit bir Phantom/Vandal taslağı) ---
        const gunGroup = new THREE.Group();
        const bodyGeo = new THREE.BoxGeometry(0.2, 0.3, 1);
        const gunMat = new THREE.MeshPhongMaterial({ color: 0x222222 });
        const gunBody = new THREE.Mesh(bodyGeo, gunMat);
        
        const barrelGeo = new THREE.CylinderGeometry(0.04, 0.04, 0.8);
        const barrel = new THREE.Mesh(barrelGeo, gunMat);
        barrel.rotation.x = Math.PI / 2;
        barrel.position.z = -0.7;
        
        gunGroup.add(gunBody);
        gunGroup.add(barrel);
        
        // Silahı kameranın önüne yerleştir
        gunGroup.position.set(0.4, -0.4, -0.8); 
        camera.add(gunGroup);

        // --- HAREKET VE KONTROLLER ---
        let keys = {};
        document.addEventListener('keydown', (e) => keys[e.code] = true);
        document.addEventListener('keyup', (e) => keys[e.code] = false);

        document.addEventListener('mousemove', (e) => {
            if (document.pointerLockElement === document.body) {
                camera.rotation.y -= e.movementX * 0.002;
                camera.rotation.x -= e.movementY * 0.002;
                camera.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, camera.rotation.x));
            }
        });

        // --- ATEŞ ETME MEKANİĞİ ---
        function shoot() {
            // Silah tepme efekti (Kickback)
            gunGroup.position.z += 0.1;
            
            // Namlu ucundan mermi izi (Raycast)
            const raycaster = new THREE.Raycaster();
            const center = new THREE.Vector2(0, 0); // Ekran ortası
            raycaster.setFromCamera(center, camera);

            // Mermi izi (Tracer)
            const lineMat = new THREE.LineBasicMaterial({ color: 0xffff00 });
            const points = [];
            points.push(new THREE.Vector3(0.4, -0.4, -1)); // Namlu yaklaşık pozisyon
            points.push(new THREE.Vector3(0, 0, -20)); // Gittiği yer
            const lineGeo = new THREE.BufferGeometry().setFromPoints(points);
            const line = new THREE.Line(lineGeo, lineMat);
            camera.add(line);
            
            // İzi kısa süre sonra sil
            setTimeout(() => camera.remove(line), 50);

            // Ekran flaşı
            const flash =